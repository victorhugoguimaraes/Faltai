"use strict";(self.webpackChunkfaltai=self.webpackChunkfaltai||[]).push([[665],{665:(e,a,s)=>{s.r(a),s.d(a,{default:()=>o});var t=s(43),l=s(204),r=s(698),i=s(594),d=s(304),m=s(58),n=s(579);const c=(0,t.lazy)((()=>s.e(977).then(s.bind(s,977))));d.t1.register(d.PP,d.kc,d.E8,d.No,d.FN,d.Bs,d.hE,d.m_,d.s$);const o=e=>{let{onClose:a}=e;const{materias:s}=(0,r.Y)(),[d,o]=(0,t.useState)("analytics"),[x,h]=(0,t.useState)(!1),b=(0,t.useMemo)((()=>{if(0===s.length)return{totalMaterias:0,totalFaltas:0,mediaFaltas:0,materiasEmRisco:0,porcentagemMedia:0,materiaComMaisFaltas:null,proximasAvaliacoes:[]};const e=s.reduce(((e,a)=>e+(Number(a.faltas)||0)),0),a=s.length>0?e/s.length:0,t=s.filter((e=>{const a=Number(e.maxFaltas)||1;return(Number(e.faltas)||0)/a>.75})),l=s.length>0?s.reduce(((e,a)=>{const s=Number(a.maxFaltas)||1;return e+(Number(a.faltas)||0)/s}),0)/s.length*100:0,r=s.reduce(((e,a)=>(Number(a.faltas)||0)>(Number(null===e||void 0===e?void 0:e.faltas)||0)?a:e),null),i=new Date,d=new Date;d.setDate(i.getDate()+7);const m=s.flatMap((e=>(e.avaliacoes||[]).map((a=>({...a,materiaName:e.nome}))))).filter((e=>{const a=new Date(e.data);return a>=i&&a<=d})).sort(((e,a)=>new Date(e.data)-new Date(a.data))).slice(0,5);return{totalMaterias:Number(s.length)||0,totalFaltas:Number(e)||0,mediaFaltas:Number(a.toFixed(2))||0,materiasEmRisco:Number(t.length)||0,porcentagemMedia:Number(l.toFixed(2))||0,materiaComMaisFaltas:r,proximasAvaliacoes:m}}),[s]),u=(0,t.useMemo)((()=>{const e=s.map((e=>{const a=String(e.nome||"Sem nome");return a.length>15?a.substring(0,15)+"...":a})),a=s.map((e=>Number(e.faltas)||0)),t=s.map((e=>Number(e.maxFaltas)||0));return{labels:e,datasets:[{label:"Faltas Atuais",data:a,backgroundColor:s.map((e=>{const a=(Number(e.faltas)||0)/(Number(e.maxFaltas)||1)*100;return a>=100?"#ef4444":a>=75?"#f59e0b":"#10b981"})),borderWidth:1},{label:"Limite M\xe1ximo",data:t,backgroundColor:"#e5e7eb",borderWidth:1}]}}),[s]),g=(0,t.useMemo)((()=>({labels:["Seguras","Aten\xe7\xe3o","Em Risco"],datasets:[{data:[s.filter((e=>(Number(e.faltas)||0)/(Number(e.maxFaltas)||1)<.5)).length,s.filter((e=>{const a=(Number(e.faltas)||0)/(Number(e.maxFaltas)||1);return a>=.5&&a<.75})).length,s.filter((e=>(Number(e.faltas)||0)/(Number(e.maxFaltas)||1)>=.75)).length],backgroundColor:["#10b981","#f59e0b","#ef4444"],borderWidth:2,borderColor:"#fff"}]})),[s]),p={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:Math.max(...s.map((e=>e.maxFaltas)))+2}}},N=e=>{let{title:a,fullTitle:s,value:t,icon:l,color:r="blue",subtitle:i}=e;return(0,n.jsx)("div",{className:`bg-white p-3 sm:p-6 rounded-lg shadow-sm border-l-4 border-${r}-500`,children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,n.jsxs)("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",title:s||a,children:[(0,n.jsx)("span",{className:"sm:hidden",children:a}),(0,n.jsx)("span",{className:"hidden sm:inline",children:s||a})]}),(0,n.jsx)("p",{className:`text-lg sm:text-2xl font-bold text-${r}-600`,children:"number"!==typeof t||isNaN(t)?"0":t}),i&&(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1 truncate",children:i})]}),(0,n.jsx)("div",{className:`text-${r}-500 ml-2 flex-shrink-0`,children:l})]})})};return 0===s.length?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-8 w-full max-w-md text-center",children:[(0,n.jsx)(l.v$b,{className:"text-6xl text-gray-400 mx-auto mb-4"}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Nenhuma Mat\xe9ria Cadastrada"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Adicione algumas mat\xe9rias para ver estat\xedsticas detalhadas no dashboard."}),(0,n.jsx)("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Fechar"})]})}):(0,n.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4 overflow-y-auto",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg w-full h-full sm:h-auto sm:max-w-6xl sm:max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-3 sm:p-6 border-b",children:[(0,n.jsxs)("h2",{className:"text-lg sm:text-2xl font-bold text-gray-800 flex items-center",children:[(0,n.jsx)(l.v$b,{className:"mr-2 sm:mr-3 text-blue-600",size:16}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Dashboard Anal\xedtico"}),(0,n.jsx)("span",{className:"sm:hidden",children:"Dashboard"})]}),(0,n.jsxs)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 p-1 sm:p-2",children:[(0,n.jsx)(l.QCr,{size:16,className:"sm:hidden"}),(0,n.jsx)(l.QCr,{size:20,className:"hidden sm:block"})]})]}),(0,n.jsx)("div",{className:"px-3 sm:px-6 pt-3 sm:pt-4",children:(0,n.jsx)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[{id:"analytics",label:"Analytics",shortLabel:"Dados",icon:(0,n.jsx)(l.v$b,{})},{id:"alerts",label:"Alertas",shortLabel:"Alertas",icon:(0,n.jsx)(l.BS8,{})},{id:"gamification",label:"Gamifica\xe7\xe3o",shortLabel:"Game",icon:(0,n.jsx)(l.SBv,{})}].map((e=>(0,n.jsxs)("button",{onClick:()=>o(e.id),className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-2 rounded-md transition-colors text-xs sm:text-sm "+(d===e.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[t.cloneElement(e.icon,{size:14}),(0,n.jsx)("span",{className:"sm:hidden",children:e.shortLabel}),(0,n.jsx)("span",{className:"hidden sm:inline",children:e.label})]},e.id)))})}),(0,n.jsxs)("div",{className:"p-3 sm:p-6",children:["analytics"===d&&(0,n.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-4",children:[(0,n.jsx)(N,{title:"Mat\xe9rias",fullTitle:"Total de Mat\xe9rias",value:b.totalMaterias,icon:(0,n.jsx)(l.v$b,{size:16}),color:"blue"}),(0,n.jsx)(N,{title:"Faltas",fullTitle:"Total de Faltas",value:b.totalFaltas,icon:(0,n.jsx)(l.BS8,{size:16}),color:"yellow"}),(0,n.jsx)(N,{title:"M\xe9dia",fullTitle:"M\xe9dia de Faltas",value:b.mediaFaltas,icon:(0,n.jsx)(l.v$b,{size:16}),color:"green",subtitle:"por mat\xe9ria"}),(0,n.jsx)(N,{title:"Risco",fullTitle:"Mat\xe9rias em Risco",value:b.materiasEmRisco,icon:(0,n.jsx)(l.BS8,{size:16}),color:"red",subtitle:"> 75% das faltas"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[(0,n.jsxs)("div",{className:"bg-white p-3 sm:p-4 rounded-lg border",children:[(0,n.jsx)("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Faltas por Mat\xe9ria"}),(0,n.jsx)("div",{className:"h-64 sm:h-80",children:(0,n.jsx)(m.yP,{data:u,options:p})})]}),(0,n.jsxs)("div",{className:"bg-white p-3 sm:p-4 rounded-lg border",children:[(0,n.jsx)("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Status das Mat\xe9rias"}),(0,n.jsx)("div",{className:"h-64 max-w-xs mx-auto",children:(0,n.jsx)(m.nu,{data:g})})]})]}),b.proximasAvaliacoes.length>0&&(0,n.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,n.jsx)(l.gUT,{className:"mr-2 text-blue-600"}),"Pr\xf3ximas Avalia\xe7\xf5es (7 dias)"]}),(0,n.jsx)("div",{className:"space-y-3",children:b.proximasAvaliacoes.map(((e,a)=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium text-gray-800",children:e.materiaName}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:e.descricao||e.tipo})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-800",children:new Date(e.data).toLocaleDateString("pt-BR")}),(0,n.jsx)("span",{className:"text-xs px-2 py-1 rounded-full "+("PROVA"===e.tipo?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.tipo})]})]},a)))})]})]}),"alerts"===d&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Alertas e Recomenda\xe7\xf5es"}),b.materiasEmRisco>0&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg",children:[(0,n.jsxs)("h4",{className:"text-red-800 font-medium flex items-center",children:[(0,n.jsx)(l.BS8,{className:"mr-2"}),"Mat\xe9rias em Risco Alto"]}),(0,n.jsx)("div",{className:"mt-2 space-y-2",children:s.filter((e=>(Number(e.faltas)||0)/(Number(e.maxFaltas)||1)>=.75)).map(((e,a)=>(0,n.jsxs)("div",{className:"text-red-700",children:[(0,n.jsx)("strong",{children:String(e.nome||"Mat\xe9ria")}),": ",Number(e.faltas)||0,"/",Number(e.maxFaltas)||0," faltas (",Math.round((Number(e.faltas)||0)/(Number(e.maxFaltas)||1)*100),"%)"]},a)))})]}),b.porcentagemMedia>50&&(0,n.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:[(0,n.jsx)("h4",{className:"text-yellow-800 font-medium",children:"M\xe9dia Geral de Faltas Alta"}),(0,n.jsxs)("p",{className:"text-yellow-700 mt-1",children:["Sua m\xe9dia geral est\xe1 em ",Number(b.porcentagemMedia)||0,"%. Considere melhorar a frequ\xeancia."]})]}),0===b.materiasEmRisco&&b.porcentagemMedia<=50&&(0,n.jsxs)("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:[(0,n.jsx)("h4",{className:"text-green-800 font-medium",children:"Parab\xe9ns! Situa\xe7\xe3o Controlada"}),(0,n.jsx)("p",{className:"text-green-700 mt-1",children:"Todas as suas mat\xe9rias est\xe3o com frequ\xeancia adequada."})]})]}),"achievements"===d&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Sistema de Conquistas"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)("div",{className:"p-4 rounded-lg border "+(b.porcentagemMedia<25?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"),children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(l.SBv,{className:"text-2xl "+(b.porcentagemMedia<25?"text-yellow-500":"text-gray-400")}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium",children:"Frequentador Exemplar"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Mantenha menos de 25% de faltas em m\xe9dia"}),b.porcentagemMedia<25&&(0,n.jsx)("p",{className:"text-xs text-yellow-600 font-medium",children:"Conquistado!"})]})]})}),(0,n.jsx)("div",{className:"p-4 rounded-lg border "+(b.totalMaterias>=5?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200"),children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(l.SBv,{className:"text-2xl "+(b.totalMaterias>=5?"text-blue-500":"text-gray-400")}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium",children:"Super Organizador"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Cadastre 5 ou mais mat\xe9rias"}),b.totalMaterias>=5&&(0,n.jsx)("p",{className:"text-xs text-blue-600 font-medium",children:"Conquistado!"})]})]})}),(0,n.jsx)("div",{className:"p-4 rounded-lg border "+(0===b.totalFaltas&&b.totalMaterias>0?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"),children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(l.SBv,{className:"text-2xl "+(0===b.totalFaltas&&b.totalMaterias>0?"text-green-500":"text-gray-400")}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium",children:"Presen\xe7a Perfeita"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Zero faltas em todas as mat\xe9rias"}),0===b.totalFaltas&&b.totalMaterias>0&&(0,n.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"Conquistado!"})]})]})}),(0,n.jsx)("div",{className:"p-4 rounded-lg border "+(b.proximasAvaliacoes.length>=3?"bg-purple-50 border-purple-200":"bg-gray-50 border-gray-200"),children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(l.SBv,{className:"text-2xl "+(b.proximasAvaliacoes.length>=3?"text-purple-500":"text-gray-400")}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium",children:"Planejador Nato"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Tenha 3+ avalia\xe7\xf5es agendadas"}),b.proximasAvaliacoes.length>=3&&(0,n.jsx)("p",{className:"text-xs text-purple-600 font-medium",children:"Conquistado!"})]})]})})]})]}),"gamification"===d&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:[(0,n.jsx)(l.SBv,{className:"mr-2 text-yellow-500"}),"Sistema de Gamifica\xe7\xe3o"]}),(0,n.jsxs)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-lg border",children:[(0,n.jsx)("div",{className:"text-center mb-4",children:(0,n.jsxs)("button",{onClick:()=>h(!0),className:"bg-gradient-primary text-white px-8 py-3 rounded-2xl hover:shadow-medium transition-all duration-200 hover:scale-105 animate-bounce-subtle flex items-center mx-auto",children:[(0,n.jsx)(l.SBv,{className:"mr-2"}),"Ver Sistema Completo"]})}),(0,n.jsx)("p",{className:"text-center text-gray-600 text-sm",children:"Acompanhe seu progresso e conquiste n\xedveis baseados na sua presen\xe7a!"})]})]})]})]}),x&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-60",children:(0,n.jsx)(t.Suspense,{fallback:(0,n.jsx)(i.Ay,{}),children:(0,n.jsx)(c,{materias:s,onClose:()=>h(!1)})})})]})}}}]);
//# sourceMappingURL=665.fa9e10c3.chunk.js.map